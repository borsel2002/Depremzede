// Internationalization support
let currentLanguage = 'tr'; // Set Turkish as default

// Translation strings
const translations = {
  'en': {
    'app-title': 'Earthquake Rescue Locator',
    'verified': 'Verified',
    'unverified': 'Unverified',
    'resolved': 'Resolved',
    'show-verified': 'Show Verified Reports',
    'show-unverified': 'Show Unverified Reports',
    'show-resolved': 'Show Resolved Reports',
    'report-button': 'Report a Person Trapped',
    'locate-me': 'Find My Location',
    'filters': 'Filters',
    'report-form-title': 'Report a Person Trapped',
    'report-heading': 'Report a Person Trapped',
    'location-description': 'Location Description',
    'location-help': 'Describe the location as precisely as possible',
    'num-people': 'Estimated Number of People',
    'situation': 'Situation Details',
    'situation-help': 'Describe the situation (building type, collapse level, etc.)',
    'contact-info': 'Contact Info (Optional)',
    'contact-help': 'Phone number or other contact method',
    'submit': 'Submit Report',
    'clear': 'Clear Form',
    'pin-location': 'Pin Exact Location',
    'pin-instructions': 'Click on the map to place a pin at the exact location',
    'confirm-location': 'Confirm Location',
    'footer-text': 'This is an open-source project aimed at helping earthquake victims.',
    'your-location': 'Your Location',
    'report': 'Report',
    'people': 'People',
    'status': 'Status',
    'time': 'Time',
    'reported': 'Reported',
    'contact': 'Contact',
    'navigate': 'Navigate',
    'verify': 'Verify',
    'resolve': 'Mark as Resolved',
    'close': '×',
    'close-detail': '×',
    'geolocation-not-supported': 'Geolocation is not supported by your browser',
    'geolocation-error': 'Unable to retrieve your location',
    'report-success': 'Report submitted successfully!',
    'report-error': 'Error submitting report. Please try again.',
    'report-offline': 'You are offline. Report saved locally.',
    'offline-message': 'You are currently offline. Some features may be limited.',
    'status-updated': 'Report status updated successfully',
    'update-error': 'Error updating report status',
    'location-required': 'Your location is required to submit a report. Please allow location access.',
    'location': 'Location',
    'p2p-connected': 'Connected to peer network',
    'p2p-disconnected': 'Disconnected from peer network',
    'sync-success': 'Successfully synchronized with other nodes',
    'sync-error': 'Error synchronizing with other nodes',
    'map-view': 'Map View',
    'list-view': 'List View',
    'no-reports': 'No reports found.',
    'search-placeholder': 'Search reports...',
    'show-on-map': 'Show on Map',
    'report-details': 'Report Details',
    'created-at': 'Created at',
    'updated-at': 'Updated at',
    'verified-at': 'Verified at',
    'resolved-at': 'Resolved at',
    'verified-by': 'Verified by',
    'resolved-by': 'Resolved by',
    'created-by': 'Created by',
    'verification-votes': 'Verification Votes',
    'resolution-votes': 'Resolution Votes',
    'vote-to-verify': 'Vote to Verify',
    'vote-to-resolve': 'Vote to Resolve',
    'voted-to-verify': 'Already Voted to Verify',
    'voted-to-resolve': 'Already Voted to Resolve',
    'already-voted': 'You have already voted for this action',
    'report-verified': 'Report has been verified by the community!',
    'report-resolved': 'Report has been resolved by the community!',
    'verification-vote-recorded': 'Your verification vote has been recorded ({current}/{required})',
    'resolution-vote-recorded': 'Your resolution vote has been recorded ({current}/{required})'
  },
  'tr': {
    'app-title': 'Deprem Kurtarma Konum Belirleyici',
    'verified': 'Doğrulanmış',
    'unverified': 'Doğrulanmamış',
    'resolved': 'Çözülmüş',
    'show-verified': 'Doğrulanmış Bildirimleri Göster',
    'show-unverified': 'Doğrulanmamış Bildirimleri Göster',
    'show-resolved': 'Çözülmüş Bildirimleri Göster',
    'report-button': 'Enkaz Bildirimi Yap',
    'locate-me': 'Konumumu Bul',
    'filters': 'Filtreler',
    'report-form-title': 'Enkaz Bildirimi',
    'report-heading': 'Enkaz Altında Kalan Kişiyi Bildir',
    'location-description': 'Konum Açıklaması',
    'location-help': 'Konumu mümkün olduğunca kesin bir şekilde tanımlayın',
    'num-people': 'Tahmini Kişi Sayısı',
    'situation': 'Durum Detayları',
    'situation-help': 'Durumu açıklayın (bina tipi, yıkım seviyesi, vb.)',
    'contact-info': 'İletişim Bilgisi (İsteğe Bağlı)',
    'contact-help': 'Telefon numarası veya başka bir iletişim yöntemi',
    'submit': 'Gönder',
    'clear': 'Temizle',
    'pin-location': 'Tam Konumu İşaretle',
    'pin-instructions': 'Tam konumu işaretlemek için haritaya tıklayın',
    'confirm-location': 'Konumu Onayla',
    'footer-text': 'Bu, deprem mağdurlarına yardım etmeyi amaçlayan açık kaynaklı bir projedir.',
    'your-location': 'Konumunuz',
    'report': 'Bildirim',
    'people': 'Kişi Sayısı',
    'status': 'Durum',
    'time': 'Zaman',
    'reported': 'Bildirilme Zamanı',
    'contact': 'İletişim',
    'navigate': 'Yol Tarifi',
    'verify': 'Doğrula',
    'resolve': 'Çözüldü Olarak İşaretle',
    'close': '×',
    'close-detail': '×',
    'geolocation-not-supported': 'Konum belirleme tarayıcınız tarafından desteklenmiyor',
    'geolocation-error': 'Konumunuz alınamadı',
    'report-success': 'Bildirim başarıyla gönderildi!',
    'report-error': 'Bildirim gönderilirken hata oluştu. Lütfen tekrar deneyin.',
    'report-offline': 'Çevrimdışısınız. Bildirim yerel olarak kaydedildi.',
    'offline-message': 'Şu anda çevrimdışısınız. Bazı özellikler sınırlı olabilir.',
    'status-updated': 'Bildirim durumu başarıyla güncellendi',
    'update-error': 'Bildirim durumu güncellenirken hata oluştu',
    'location-required': 'Bildirim göndermek için konumunuz gereklidir. Lütfen konum erişimine izin verin.',
    'location': 'Konum',
    'p2p-connected': 'Eşler arası ağa bağlandı',
    'p2p-disconnected': 'Eşler arası ağ bağlantısı kesildi',
    'sync-success': 'Diğer düğümlerle başarıyla senkronize edildi',
    'sync-error': 'Diğer düğümlerle senkronizasyon hatası',
    'map-view': 'Harita Görünümü',
    'list-view': 'Liste Görünümü',
    'no-reports': 'Henüz rapor bulunmamaktadır.',
    'search-placeholder': 'Raporları Ara...',
    'show-on-map': 'Haritada Göster',
    'report-details': 'Rapor Detayları',
    'created-at': 'Oluşturulma Zamanı',
    'updated-at': 'Güncellenme Zamanı',
    'verified-at': 'Doğrulanma Zamanı',
    'resolved-at': 'Çözülme Zamanı',
    'verified-by': 'Doğrulayan',
    'resolved-by': 'Çözen',
    'created-by': 'Oluşturan',
    'verification-votes': 'Doğrulama Oyları',
    'resolution-votes': 'Çözüm Oyları',
    'vote-to-verify': 'Doğrulamak için Oy Ver',
    'vote-to-resolve': 'Çözüldü Olarak İşaretlemek için Oy Ver',
    'voted-to-verify': 'Doğrulama için Zaten Oy Verildi',
    'voted-to-resolve': 'Çözüm için Zaten Oy Verildi',
    'already-voted': 'Bu işlem için zaten oy verdiniz',
    'report-verified': 'Rapor topluluk tarafından doğrulandı!',
    'report-resolved': 'Rapor topluluk tarafından çözüldü olarak işaretlendi!',
    'verification-vote-recorded': 'Doğrulama oyunuz kaydedildi ({current}/{required})',
    'resolution-vote-recorded': 'Çözüm oyunuz kaydedildi ({current}/{required})'
  },
  'ar': {
    'app-title': 'محدد موقع الإنقاذ من الزلازل',
    'verified': 'تم التحقق',
    'unverified': 'غير مؤكد',
    'resolved': 'تم الحل',
    'show-verified': 'عرض التقارير المؤكدة',
    'show-unverified': 'عرض التقارير غير المؤكدة',
    'show-resolved': 'عرض التقارير المحلولة',
    'report-button': 'الإبلاغ عن شخص محاصر',
    'locate-me': 'العثور على موقعي',
    'filters': 'المرشحات',
    'report-form-title': 'الإبلاغ عن شخص محاصر',
    'report-heading': 'الإبلاغ عن شخص محاصر',
    'location-description': 'وصف الموقع',
    'location-help': 'صف الموقع بأكبر قدر ممكن من الدقة',
    'num-people': 'العدد التقديري للأشخاص',
    'situation': 'تفاصيل الوضع',
    'situation-help': 'صف الوضع (نوع المبنى، مستوى الانهيار، إلخ)',
    'contact-info': 'معلومات الاتصال (اختياري)',
    'contact-help': 'رقم الهاتف أو طريقة اتصال أخرى',
    'submit': 'إرسال التقرير',
    'clear': 'مسح النموذج',
    'pin-location': 'تحديد الموقع الدقيق',
    'pin-instructions': 'انقر على الخريطة لوضع دبوس في الموقع الدقيق',
    'confirm-location': 'تأكيد الموقع',
    'footer-text': 'هذا مشروع مفتوح المصدر يهدف إلى مساعدة ضحايا الزلازل.',
    'your-location': 'موقعك',
    'report': 'تقرير',
    'people': 'الأشخاص',
    'status': 'الحالة',
    'time': 'الوقت',
    'reported': 'تم الإبلاغ',
    'contact': 'الاتصال',
    'navigate': 'التنقل',
    'verify': 'التحقق',
    'resolve': 'وضع علامة كمحلول',
    'close': '×',
    'close-detail': '×',
    'geolocation-not-supported': 'تحديد الموقع الجغرافي غير مدعوم من قبل متصفحك',
    'geolocation-error': 'غير قادر على استرداد موقعك',
    'report-success': 'تم إرسال التقرير بنجاح!',
    'report-error': 'خطأ في إرسال التقرير. يرجى المحاولة مرة أخرى.',
    'report-offline': 'أنت غير متصل بالإنترنت. تم حفظ التقرير محليًا.',
    'offline-message': 'أنت حاليًا غير متصل بالإنترنت. قد تكون بعض الميزات محدودة.',
    'status-updated': 'تم تحديث حالة التقرير بنجاح',
    'update-error': 'خطأ في تحديث حالة التقرير',
    'location-required': 'موقعك مطلوب لإرسال تقرير. يرجى السماح بالوصول إلى الموقع.',
    'location': 'الموقع',
    'p2p-connected': 'متصل بشبكة الأقران',
    'p2p-disconnected': 'انقطع الاتصال بشبكة الأقران',
    'sync-success': 'تمت المزامنة بنجاح مع العقد الأخرى',
    'sync-error': 'خطأ في المزامنة مع العقد الأخرى',
    'map-view': 'عرض الخريطة',
    'list-view': 'عرض القائمة',
    'no-reports': 'لم يتم العثور على تقارير.',
    'search-placeholder': 'البحث في التقارير...',
    'show-on-map': 'عرض على الخريطة',
    'report-details': 'تفاصيل التقرير',
    'created-at': 'تم الإنشاء في',
    'updated-at': 'تم التحديث في',
    'verified-at': 'تم التحقق في',
    'resolved-at': 'تم الحل في',
    'verified-by': 'تم التحقق بواسطة',
    'resolved-by': 'تم الحل بواسطة',
    'created-by': 'تم الإنشاء بواسطة',
    'verification-votes': 'أصوات التحقق',
    'resolution-votes': 'أصوات الحل',
    'vote-to-verify': 'التصويت للتحقق',
    'vote-to-resolve': 'التصويت للحل',
    'voted-to-verify': 'تم التصويت بالفعل للتحقق',
    'voted-to-resolve': 'تم التصويت بالفعل للحل',
    'already-voted': 'لقد قمت بالتصويت بالفعل لهذا الإجراء',
    'report-verified': 'تم التحقق من التقرير من قبل المجتمع!',
    'report-resolved': 'تم حل التقرير من قبل المجتمع!',
    'verification-vote-recorded': 'تم تسجيل صوتك للتحقق ({current}/{required})',
    'resolution-vote-recorded': 'تم تسجيل صوتك للحل ({current}/{required})'
  },
  'es': {
    'app-title': 'Localizador de Rescate de Terremotos',
    'verified': 'Verificado',
    'unverified': 'No Verificado',
    'resolved': 'Resuelto',
    'show-verified': 'Mostrar Informes Verificados',
    'show-unverified': 'Mostrar Informes No Verificados',
    'show-resolved': 'Mostrar Informes Resueltos',
    'report-button': 'Informar de una Persona Atrapada',
    'locate-me': 'Encontrar Mi Ubicación',
    'filters': 'Filtros',
    'report-form-title': 'Informar de una Persona Atrapada',
    'report-heading': 'Informar de una Persona Atrapada',
    'location-description': 'Descripción de la Ubicación',
    'location-help': 'Describa la ubicación con la mayor precisión posible',
    'num-people': 'Número Estimado de Personas',
    'situation': 'Detalles de la Situación',
    'situation-help': 'Describa la situación (tipo de edificio, nivel de colapso, etc.)',
    'contact-info': 'Información de Contacto (Opcional)',
    'contact-help': 'Número de teléfono u otro método de contacto',
    'submit': 'Enviar Informe',
    'clear': 'Limpiar Formulario',
    'pin-location': 'Marcar Ubicación Exacta',
    'pin-instructions': 'Haga clic en el mapa para colocar un pin en la ubicación exacta',
    'confirm-location': 'Confirmar Ubicación',
    'footer-text': 'Este es un proyecto de código abierto destinado a ayudar a las víctimas de terremotos.',
    'your-location': 'Su Ubicación',
    'report': 'Informe',
    'people': 'Personas',
    'status': 'Estado',
    'time': 'Tiempo',
    'reported': 'Reportado',
    'contact': 'Contacto',
    'navigate': 'Navegar',
    'verify': 'Verificar',
    'resolve': 'Marcar como Resuelto',
    'close': '×',
    'close-detail': '×',
    'geolocation-not-supported': 'La geolocalización no es compatible con su navegador',
    'geolocation-error': 'No se puede recuperar su ubicación',
    'report-success': '¡Informe enviado con éxito!',
    'report-error': 'Error al enviar el informe. Por favor, inténtelo de nuevo.',
    'report-offline': 'Está desconectado. El informe se guardó localmente.',
    'offline-message': 'Actualmente está desconectado. Algunas funciones pueden estar limitadas.',
    'status-updated': 'Estado del informe actualizado con éxito',
    'update-error': 'Error al actualizar el estado del informe',
    'location-required': 'Se requiere su ubicación para enviar un informe. Por favor, permita el acceso a la ubicación.',
    'location': 'Ubicación',
    'p2p-connected': 'Conectado a la red de pares',
    'p2p-disconnected': 'Desconectado de la red de pares',
    'sync-success': 'Sincronizado con éxito con otros nodos',
    'sync-error': 'Error al sincronizar con otros nodos',
    'map-view': 'Vista de Mapa',
    'list-view': 'Vista de Lista',
    'no-reports': 'No se encontraron informes.',
    'search-placeholder': 'Buscar informes...',
    'show-on-map': 'Mostrar en el Mapa',
    'report-details': 'Detalles del Informe',
    'created-at': 'Creado el',
    'updated-at': 'Actualizado el',
    'verified-at': 'Verificado el',
    'resolved-at': 'Resuelto el',
    'verified-by': 'Verificado por',
    'resolved-by': 'Resuelto por',
    'created-by': 'Creado por',
    'verification-votes': 'Votos de Verificación',
    'resolution-votes': 'Votos de Resolución',
    'vote-to-verify': 'Votar para Verificar',
    'vote-to-resolve': 'Votar para Resolver',
    'voted-to-verify': 'Ya Votado para Verificar',
    'voted-to-resolve': 'Ya Votado para Resolver',
    'already-voted': 'Ya has votado para esta acción',
    'report-verified': '¡El informe ha sido verificado por la comunidad!',
    'report-resolved': '¡El informe ha sido resuelto por la comunidad!',
    'verification-vote-recorded': 'Tu voto de verificación ha sido registrado ({current}/{required})',
    'resolution-vote-recorded': 'Tu voto de resolución ha sido registrado ({current}/{required})'
  }
};

// Initialize language
function initLanguage() {
  // Get language from localStorage or use default
  const savedLanguage = localStorage.getItem('language');
  if (savedLanguage && config.supportedLanguages.includes(savedLanguage)) {
    currentLanguage = savedLanguage;
  }
  
  // Set the language selector
  document.getElementById('language-select').value = currentLanguage;
  
  // Apply translations
  applyTranslations();
}

// Change language
function changeLanguage(lang) {
  if (!config.supportedLanguages.includes(lang)) return;
  
  currentLanguage = lang;
  localStorage.setItem('language', lang);
  
  // Apply translations
  applyTranslations();
}

// Apply translations to the page
function applyTranslations() {
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (translations[currentLanguage][key]) {
      el.textContent = translations[currentLanguage][key];
    }
  });
  
  // Update placeholders
  const searchInput = document.getElementById('search-reports');
  if (searchInput) {
    searchInput.placeholder = getTranslation('search-placeholder');
  }
}

// Get translation for a key
function getTranslation(key) {
  if (translations[currentLanguage] && translations[currentLanguage][key]) {
    return translations[currentLanguage][key];
  }
  
  // Fallback to English
  if (translations['en'] && translations['en'][key]) {
    return translations['en'][key];
  }
  
  // Return the key if no translation found
  return key;
}
